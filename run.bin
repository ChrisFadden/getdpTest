#! /usr/bin/bash

#Set variables
simHome='/home/czf41/Github/getdpTest'

h5_name='output.h5'

inputH5=$simHome'/SimParam/'$h5_name
inputMesh=$simHome'/SimParam/microstrip.msh'

outputH5=$simHome'/build/'$h5_name
outputDat=$simHome'/build/Vnode.dat'
outputPlot=$simHome'/build/output.pos'

#Python Home
pyHome='/home/czf41/Github/getdpTest'


#Create Mesh
cd $pyHome/Python/
python h5toGmsh.py $inputH5 $inputMesh
cd ..

#Create environment
rm -rf $simHome/build
cp -r $simHome/SimParam $simHome/build
cp $simHome/saveFig.bin $simHome/build/

#Run Simulations
cd $simHome/build

#Solve the FEM proble#m
getdp microstrip.pro -solve EleSta_v -pos Map

#Save the Data
cd $pyHome/Python/
python saveData.py $outputH5 $outputDat 
python plotFile.py $outputH5 $outputPlot
